# coding=utf-8

from copy import deepcopy


class Solution(object):
    def shiftGrid(self, grid, k):
        """
        :type grid: List[List[int]]
        :type k: int
        :rtype: List[List[int]]
        """
        # 有一个很巧妙的办法
        # 先把双重数组打平
        # 再从顺序轮转
        if not grid or not grid[0]:
            return grid
        new_grid = []
        m = len(grid[0])
        for g in grid:
            new_grid.extend(g)
        k %= len(new_grid)
        new_grid = new_grid[-k:]+new_grid[:-k]
        result = []
        for i in range(0, len(new_grid), m):
            result.append(new_grid[i:i+m])
        return result

    def _shiftGrid(self, grid, k):
        """
        :type grid: List[List[int]]
        :type k: int
        :rtype: List[List[int]]
        """
        # Time Limit
        if not grid or not grid[0]:
            return grid
        length = len(grid) * len(grid[0])
        k %= length
        for i in range(k):
            grid = self.transfer(grid)
        return grid

    def transfer(self, grid):
        new_grid = deepcopy(grid)
        for i in range(len(grid)):
            for j in range(len(grid[0])):
                if j < len(grid[0]) - 1:
                    new_grid[i][j+1] = grid[i][j]
                else:
                    if i < len(grid) - 1:
                        new_grid[i+1][0] = grid[i][j]
                    else:
                        new_grid[0][0] = grid[i][j]
        return new_grid


if __name__ == '__main__':
    s = Solution()
    print s.shiftGrid([[1,2,3],[4,5,6],[7,8,9]], 1)
    print s.shiftGrid([[3,8,1,9],[19,7,2,5],[4,6,11,10],[12,0,21,13]], 4)
    print s.shiftGrid([[1,2,3],[4,5,6],[7,8,9]], 9)
    print s.shiftGrid([[489,-858,-17,337,20,846,-660,485,-401,521,-120,-678,-211,154,-635,-700,227,-611,367,-844,-615,653,300,437,851,-270,260,-114,398,-718,941,522,945,-370,-639,-169,751,526,734],[37,491,852,102,-600,-762,620,-358,505,-172,-40,355,27,649,-631,-905,-264,671,863,426,440,-632,130,32,21,193,967,-257,-327,417,-85,424,-963,786,-496,185,528,-765,395],[-10,-223,-843,-514,136,757,-817,253,936,183,276,283,-979,-156,657,819,232,-290,698,14,758,818,-57,-871,665,-471,190,-381,-5,861,-905,-556,-688,554,-645,891,-482,108,-175],[-81,-832,638,-618,-129,894,734,660,805,615,-737,-545,776,151,-89,56,-720,-52,-306,976,864,258,715,168,-606,230,622,-245,476,-463,-585,565,-947,-831,403,-724,-336,-197,-922],[-278,600,-93,394,419,950,-177,-70,-705,350,-539,516,-100,745,-350,788,-480,-43,-688,949,232,810,-386,18,-696,-516,985,573,934,-510,893,-114,-423,820,371,668,-450,347,-998],[-228,687,130,-819,-159,336,-825,129,47,-360,862,-320,-774,510,667,116,-116,675,-126,-516,-41,-399,953,-871,-768,-201,-412,145,827,179,-723,-511,905,-48,776,-313,-4,-624,-245],[69,942,-559,691,54,402,715,314,-718,129,-552,-478,-742,-339,488,708,565,856,36,-49,-163,-512,-680,-300,203,-676,436,645,-219,-144,-846,133,276,-603,-700,821,441,-96,-39],[-218,-830,514,454,90,869,56,170,-806,252,470,764,-786,273,-697,125,114,37,-347,-377,-401,-781,-484,230,-176,-937,844,-372,279,-464,724,-89,522,729,168,364,-918,-186,-394],[325,616,659,886,254,-559,-223,898,-428,877,48,70,272,674,-727,-354,977,-38,-182,-134,714,-796,992,411,-971,82,-249,630,-929,-763,959,-2,702,-694,-491,-19,-753,347,-926],[-235,-712,367,-317,-332,905,-227,-91,-862,524,-341,499,-325,-441,-239,-827,-404,-731,609,-665,-782,-127,440,-816,-630,-640,142,54,149,852,755,-934,-462,929,-920,-786,-792,217,635],[338,-43,119,775,629,415,958,445,-604,742,887,-474,-813,96,381,766,-834,71,-325,-696,535,985,702,-507,-381,-328,-423,-487,487,231,-749,300,-184,455,-542,-598,-882,-216,-797],[-19,-589,822,-444,386,-548,348,513,44,-106,661,79,685,195,783,-166,532,-696,-55,-973,945,847,465,141,-490,65,-934,-220,-698,735,-573,-518,-835,844,-468,943,-110,-189,-266],[342,876,-160,295,-882,-108,-961,-296,357,779,538,-781,-456,-556,986,-219,-304,-601,902,-828,-315,-88,315,244,271,805,-555,-249,-985,-36,773,22,629,125,73,-648,-638,929,857],[876,-895,547,-321,-891,145,165,-548,-448,880,117,986,503,-759,144,-953,670,-339,561,-753,-982,-463,-552,-527,451,29,-782,139,372,-224,356,-696,230,452,636,284,-2,916,247]], 100)
